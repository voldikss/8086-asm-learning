# 第九章 转移指令的原理

### 内容

- 转移行为：

  - 定义：修改 CS 或 IP
  - 种类：
    - 段内转移：只修改 IP
      - 短转移：修改 IP 范围 -128~127
      - 近转移：修改 IP 范围 -32768~32767
    - 段间转移：修改 CS 和 IP

- `offset`：取得标号的偏移地址
- `jmp`：无条件转移指令

  - `jmp short 标号` 段内短转移，对 IP 的修改范围 -128~127。注意这个指令所对应的机器码中，并不包含转移的目的地址，而包含的是转移的位移，这个位移由编译器计算出
  - `jmp near ptr 标号` 段内近转移
  - `jmp far ptr 标号` 段间转移，又叫远转移
  - `jmp 16位reg` 设置 IP
  - `jmp word ptr 内存单元地址（段内转移）`内存存放转移的目的偏移地址
  - `jmp dword ptr 内存单元地址（段间转移）` 低地址存放转移的目的偏移地址，高地址存放目的段地址

- `jcxz`：条件转移指令

  - 条件转移指令都是短转移，对 IP 的修改范围：-128~127
  - `jcxz 标号`
  - 如果 `cx`为 0，转移到标号处

- `jcxz & jmp`：`jcxz` 相当于 `if ((cx)==0) jmp short 标号`

- `loop & jmp`：`loop` 相当于 `(cx--); if ((cx) != 0) jmp short 标号`

### 检测点 9.1

- (1)
  `db 3 dup (0)`

- (2)
  - `bx`
  - `start`
- (3)
  - `0006h`
  - `00beh`

### 检测点 9.2

- 代码：[j9-2](./J9-2.ASM)
- 答案：
  ```masm
  mov cl,[bx]
  mov ch,0
  jcxz ok
  ```

### 检测点 9.3

- 答案：
  ```masm
  inc cx
  ```
